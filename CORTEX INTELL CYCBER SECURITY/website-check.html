<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Website Security Scanner - Cortex-Intell</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
    --primary: #6366f1;
    --primary-dark: #4f46e5;
    --primary-light: #8b5cf6;
    --secondary: #06d6a0;
    --error: #ef4444;
    --warning: #f59e0b;
    --success: #10b981;
    --bg-primary: #0a0a0a;
    --bg-secondary: #111111;
    --bg-tertiary: #1a1a1a;
    --text-primary: #ffffff;
    --text-secondary: #a1a1aa;
    --text-muted: #71717a;
    --border-light: rgba(255, 255, 255, 0.1);
    --border-medium: rgba(255, 255, 255, 0.2);
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.25rem;
    --space-6: 1.5rem;
    --space-8: 2rem;
    --space-10: 2.5rem;
    --space-12: 3rem;
    --radius-sm: 0.25rem;
    --radius-md: 0.5rem;
    --radius-lg: 0.75rem;
    --radius-xl: 1rem;
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
}

[data-theme="light"] {
    --bg-primary: #ffffff;
    --bg-secondary: #f8fafc;
    --bg-tertiary: #f1f5f9;
    --text-primary: #0f172a;
    --text-secondary: #475569;
    --text-muted: #64748b;
    --border-light: rgba(0, 0, 0, 0.1);
    --border-medium: rgba(0, 0, 0, 0.2);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.6;
    transition: background-color 0.3s, color 0.3s;
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
}

/* Animated GIF Background */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        linear-gradient(135deg, rgba(10, 10, 10, 0.95) 0%, rgba(17, 17, 17, 0.98) 100%),
        url('https://cybersafe.news/wp-content/uploads/2018/10/digital-security.gif') center/cover no-repeat;
    z-index: -1;
    animation: backgroundShift 20s ease-in-out infinite;
}

@keyframes backgroundShift {
    0%, 100% {
        transform: scale(1);
        opacity: 0.8;
    }
    50% {
        transform: scale(1.02);
        opacity: 1;
    }
}

/* Light theme background adjustment */
[data-theme="light"] body::before {
    background: 
        linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.98) 100%),
        url('https://cybersafe.news/wp-content/uploads/2018/10/digital-security.gif') center/cover no-repeat;
}

.navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 23, 42, 0.8);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border-light);
    z-index: 1000;
    padding: var(--space-4) 0;
}

.nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--space-6);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    text-decoration: none;
    color: var(--text-primary);
    font-weight: var(--font-weight-bold);
    font-size: 1.25rem;
}

.logo-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
}

.nav-actions {
    display: flex;
    gap: var(--space-4);
}

.theme-toggle {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    color: var(--text-primary);
    cursor: pointer;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.theme-toggle:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateY(-2px);
}

main {
    padding-top: 100px;
    min-height: 100vh;
}

.container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 var(--space-6);
}

.analyzer-container {
    background: rgba(17, 17, 17, 0.8);
    backdrop-filter: blur(20px);
    border-radius: var(--radius-xl);
    border: 1px solid var(--border-light);
    overflow: hidden;
    box-shadow: var(--shadow-lg);
    position: relative;
}

.analyzer-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--primary), var(--secondary));
    animation: scanLine 3s ease-in-out infinite;
}

@keyframes scanLine {
    0%, 100% {
        transform: translateX(-100%);
        opacity: 0;
    }
    50% {
        transform: translateX(100%);
        opacity: 1;
    }
}

.analyzer-content {
    padding: var(--space-8);
}

.input-group {
    margin-bottom: var(--space-8);
}

.input-header {
    text-align: center;
    margin-bottom: var(--space-6);
}

.input-header h1 {
    font-size: 2.5rem;
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--space-2);
    background: linear-gradient(135deg, var(--text-primary), var(--primary-light));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.input-header p {
    color: var(--text-secondary);
    font-size: 1.1rem;
}

.ai-tools-status {
    display: flex;
    gap: var(--space-4);
    margin-bottom: var(--space-6);
    flex-wrap: wrap;
    justify-content: center;
}

.tool-status {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-4);
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-md);
    font-size: 0.9rem;
    border: 1px solid var(--border-light);
    transition: all 0.3s ease;
}

.tool-status:hover {
    transform: translateY(-2px);
    border-color: var(--primary);
    box-shadow: 0 8px 25px rgba(99, 102, 241, 0.2);
}

.tool-status.active {
    background: rgba(16, 185, 129, 0.1);
    border-color: rgba(16, 185, 129, 0.3);
}

.tool-status i {
    color: var(--success);
}

.input-container {
    display: flex;
    gap: var(--space-4);
    margin-bottom: var(--space-6);
}

.input-with-icon {
    flex: 1;
    position: relative;
}

.input-with-icon i {
    position: absolute;
    left: var(--space-4);
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    z-index: 1;
}

input[type="url"] {
    width: 100%;
    padding: var(--space-4) var(--space-4) var(--space-4) var(--space-10);
    background: var(--bg-primary);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    color: var(--text-primary);
    font-size: 1rem;
    transition: all 0.3s ease;
}

input[type="url"]:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.btn {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-4) var(--space-6);
    background: var(--primary);
    color: white;
    border: none;
    border-radius: var(--radius-lg);
    font-size: 1rem;
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    position: relative;
    overflow: hidden;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.btn:hover::before {
    left: 100%;
}

.btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

.btn:active {
    transform: translateY(0);
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
}

.btn-large {
    padding: var(--space-5) var(--space-8);
    font-size: 1.1rem;
}

.api-keys-section {
    margin: var(--space-8) 0;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    overflow: hidden;
    position: relative;
}

.api-keys-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--success);
}

.api-keys-section details {
    padding: var(--space-4);
}

.api-keys-section summary {
    cursor: pointer;
    font-weight: var(--font-weight-medium);
    padding: var(--space-2);
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.api-keys-grid {
    display: grid;
    gap: var(--space-4);
    margin-top: var(--space-4);
}

.api-key-input {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.api-key-input label {
    font-size: 0.9rem;
    color: var(--text-secondary);
    font-weight: var(--font-weight-medium);
}

.api-key-input input {
    padding: var(--space-3);
    background: var(--bg-primary);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-md);
    color: var(--text-primary);
    font-family: monospace;
    font-size: 0.8rem;
    transition: all 0.3s ease;
}

.api-key-input input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.api-key-status {
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-top: 4px;
}

.api-keys-status {
    margin-top: var(--space-4);
}

.status-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-md);
    font-size: 0.9rem;
    font-weight: var(--font-weight-medium);
}

.status-badge.success {
    background: rgba(16, 185, 129, 0.1);
    color: var(--success);
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.sample-suggestions {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    flex-wrap: wrap;
    margin-top: var(--space-6);
    padding: var(--space-4);
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-lg);
}

.sample-suggestions span {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.sample-btn {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-light);
    color: var(--text-primary);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-md);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.sample-btn:hover {
    background: var(--primary);
    color: white;
    transform: translateY(-1px);
}

.results-area {
    min-height: 200px;
}

.results-placeholder {
    text-align: center;
    padding: var(--space-10);
    color: var(--text-secondary);
}

.placeholder-icon {
    font-size: 3rem;
    margin-bottom: var(--space-4);
    opacity: 0.5;
}

.loading-state {
    text-align: center;
    padding: var(--space-8);
}

.loading-spinner {
    font-size: 2.5rem;
    margin-bottom: var(--space-4);
    color: var(--primary);
}

.loading-steps {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    margin: var(--space-6) 0;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
}

.loading-step {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3);
    background: rgba(255, 255, 255, 0.05);
    border-radius: var(--radius-md);
    transition: all 0.3s ease;
}

.loading-step.active {
    background: rgba(99, 102, 241, 0.1);
    border-left: 3px solid var(--primary);
}

.scan-progress {
    margin-top: var(--space-6);
}

.progress-text {
    margin-bottom: var(--space-2);
    font-size: 0.9rem;
    color: var(--text-secondary);
}

.progress-bar {
    height: 6px;
    background: var(--bg-tertiary);
    border-radius: 3px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary), var(--success));
    border-radius: 3px;
    transition: width 0.5s ease;
    width: 0%;
    animation: progressAnimation 2s ease-in-out infinite;
}

@keyframes progressAnimation {
    0% { transform: translateX(-100%); }
    50% { transform: translateX(0%); }
    100% { transform: translateX(100%); }
}

.threat-result {
    background: var(--bg-primary);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-light);
    overflow: hidden;
}

.threat-result.clean {
    border-left: 4px solid var(--success);
}

.threat-result.suspicious {
    border-left: 4px solid var(--warning);
}

.threat-result.malicious {
    border-left: 4px solid var(--error);
}

.threat-header {
    padding: var(--space-6);
    border-bottom: 1px solid var(--border-light);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--space-4);
}

.threat-title {
    font-size: 1.5rem;
    font-weight: var(--font-weight-bold);
}

.threat-confidence {
    padding: var(--space-2) var(--space-4);
    border-radius: var(--radius-md);
    font-weight: var(--font-weight-bold);
    font-size: 0.9rem;
}

.confidence-high {
    background: rgba(16, 185, 129, 0.1);
    color: var(--success);
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.confidence-medium {
    background: rgba(245, 158, 11, 0.1);
    color: var(--warning);
    border: 1px solid rgba(245, 158, 11, 0.3);
}

.confidence-low {
    background: rgba(239, 68, 68, 0.1);
    color: var(--error);
    border: 1px solid rgba(239, 68, 68, 0.3);
}

.threat-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-4);
    padding: var(--space-6);
    border-bottom: 1px solid var(--border-light);
}

.detail-item h4 {
    font-size: 0.9rem;
    color: var(--text-secondary);
    margin-bottom: var(--space-1);
    font-weight: var(--font-weight-medium);
}

.detail-item p {
    font-weight: var(--font-weight-semibold);
}

.scan-results-section {
    padding: var(--space-6);
    border-bottom: 1px solid var(--border-light);
}

.scan-results-section h4 {
    margin-bottom: var(--space-4);
    font-size: 1.1rem;
}

.scan-results-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-4);
}

.scan-result-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    text-align: center;
    transition: all 0.3s ease;
}

.scan-result-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.scan-result-card.safe {
    border-left: 4px solid var(--success);
}

.scan-result-card.warning {
    border-left: 4px solid var(--warning);
}

.scan-result-card.danger {
    border-left: 4px solid var(--error);
}

.scan-result-card h4 {
    margin-bottom: var(--space-2);
    font-size: 1rem;
}

.scan-status {
    font-weight: var(--font-weight-bold);
    margin: var(--space-2) 0;
    font-size: 0.9rem;
}

.scan-status.clean {
    color: var(--success);
}

.scan-status.suspicious {
    color: var(--warning);
}

.scan-status.malicious {
    color: var(--error);
}

.scan-stats {
    display: flex;
    gap: var(--space-2);
    justify-content: center;
    flex-wrap: wrap;
    margin-top: var(--space-2);
}

.scan-stats small {
    background: rgba(255, 255, 255, 0.1);
    padding: 2px 6px;
    border-radius: var(--radius-sm);
    font-size: 0.7rem;
}

.threat-recommendations {
    padding: var(--space-6);
    border-bottom: 1px solid var(--border-light);
}

.threat-recommendations:last-child {
    border-bottom: none;
}

.threat-recommendations h4 {
    margin-bottom: var(--space-4);
    font-size: 1.1rem;
}

.threat-recommendations ul {
    list-style: none;
}

.threat-recommendations li {
    padding: var(--space-2) 0;
    display: flex;
    align-items: flex-start;
    gap: var(--space-2);
}

.threat-recommendations li:before {
    content: "â€¢";
    color: var(--primary);
    font-weight: bold;
}

.analysis-meta {
    padding: var(--space-4) var(--space-6);
    background: rgba(255, 255, 255, 0.03);
    text-align: center;
    color: var(--text-muted);
    font-size: 0.8rem;
}

.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: var(--space-4);
    border-radius: var(--radius-lg);
    color: white;
    z-index: 1000;
    max-width: 400px;
    box-shadow: var(--shadow-lg);
    animation: slideIn 0.3s ease-out;
    backdrop-filter: blur(10px);
}

.notification.success {
    background: rgba(16, 185, 129, 0.9);
}

.notification.error {
    background: rgba(239, 68, 68, 0.9);
}

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

/* Responsive Design */
@media (max-width: 768px) {
    .input-container {
        flex-direction: column;
    }
    
    .ai-tools-status {
        flex-direction: column;
        align-items: center;
    }
    
    .threat-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .threat-details {
        grid-template-columns: 1fr;
    }
    
    .scan-results-grid {
        grid-template-columns: 1fr;
    }
    
    .input-header h1 {
        font-size: 2rem;
    }
    
    .analyzer-content {
        padding: var(--space-6);
    }
}

@media (max-width: 480px) {
    .container {
        padding: 0 var(--space-4);
    }
    
    .analyzer-content {
        padding: var(--space-4);
    }
    
    .input-header h1 {
        font-size: 1.75rem;
    }
    
    .btn-large {
        padding: var(--space-4) var(--space-6);
        font-size: 1rem;
    }
}

        .api-keys-section {
            margin: var(--space-8) 0;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .api-keys-section details {
            padding: var(--space-4);
        }

        .api-keys-section summary {
            cursor: pointer;
            font-weight: var(--font-weight-medium);
            padding: var(--space-2);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .api-keys-grid {
            display: grid;
            gap: var(--space-4);
            margin-top: var(--space-4);
        }

        .api-key-input {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .api-key-input label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: var(--font-weight-medium);
        }

        .api-key-input input {
            padding: var(--space-3);
            background: var(--bg-primary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-family: monospace;
            font-size: 0.8rem;
        }

        .api-key-status {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .api-keys-status {
            margin-top: var(--space-4);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: var(--font-weight-medium);
        }

        .status-badge.success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .sample-suggestions {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            flex-wrap: wrap;
            margin-top: var(--space-6);
            padding: var(--space-4);
            background: rgba(255, 255, 255, 0.03);
            border-radius: var(--radius-lg);
        }

        .sample-suggestions span {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .sample-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-light);
            color: var(--text-primary);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .sample-btn:hover {
            background: var(--primary);
            color: white;
        }

        .results-area {
            min-height: 200px;
        }

        .results-placeholder {
            text-align: center;
            padding: var(--space-10);
            color: var(--text-secondary);
        }

        .placeholder-icon {
            font-size: 3rem;
            margin-bottom: var(--space-4);
            opacity: 0.5;
        }

        .loading-state {
            text-align: center;
            padding: var(--space-8);
        }

        .loading-spinner {
            font-size: 2.5rem;
            margin-bottom: var(--space-4);
            color: var(--primary);
        }

        .loading-steps {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            margin: var(--space-6) 0;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .loading-step {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-md);
            transition: all 0.3s;
        }

        .loading-step.active {
            background: rgba(99, 102, 241, 0.1);
            border-left: 3px solid var(--primary);
        }

        .scan-progress {
            margin-top: var(--space-6);
        }

        .progress-text {
            margin-bottom: var(--space-2);
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .progress-bar {
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--success));
            border-radius: 3px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .threat-result {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-light);
            overflow: hidden;
        }

        .threat-result.clean {
            border-left: 4px solid var(--success);
        }

        .threat-result.suspicious {
            border-left: 4px solid var(--warning);
        }

        .threat-result.malicious {
            border-left: 4px solid var(--error);
        }

        .threat-header {
            padding: var(--space-6);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-4);
        }

        .threat-title {
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
        }

        .threat-confidence {
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-md);
            font-weight: var(--font-weight-bold);
            font-size: 0.9rem;
        }

        .confidence-high {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .confidence-medium {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .confidence-low {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .threat-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-4);
            padding: var(--space-6);
            border-bottom: 1px solid var(--border-light);
        }

        .detail-item h4 {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: var(--space-1);
            font-weight: var(--font-weight-medium);
        }

        .detail-item p {
            font-weight: var(--font-weight-semibold);
        }

        .scan-results-section {
            padding: var(--space-6);
            border-bottom: 1px solid var(--border-light);
        }

        .scan-results-section h4 {
            margin-bottom: var(--space-4);
            font-size: 1.1rem;
        }

        .scan-results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-4);
        }

        .scan-result-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            text-align: center;
        }

        .scan-result-card.safe {
            border-left: 4px solid var(--success);
        }

        .scan-result-card.warning {
            border-left: 4px solid var(--warning);
        }

        .scan-result-card.danger {
            border-left: 4px solid var(--error);
        }

        .scan-result-card h4 {
            margin-bottom: var(--space-2);
            font-size: 1rem;
        }

        .scan-status {
            font-weight: var(--font-weight-bold);
            margin: var(--space-2) 0;
            font-size: 0.9rem;
        }

        .scan-status.clean {
            color: var(--success);
        }

        .scan-status.suspicious {
            color: var(--warning);
        }

        .scan-status.malicious {
            color: var(--error);
        }

        .scan-stats {
            display: flex;
            gap: var(--space-2);
            justify-content: center;
            flex-wrap: wrap;
            margin-top: var(--space-2);
        }

        .scan-stats small {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
        }

        .threat-recommendations {
            padding: var(--space-6);
            border-bottom: 1px solid var(--border-light);
        }

        .threat-recommendations:last-child {
            border-bottom: none;
        }

        .threat-recommendations h4 {
            margin-bottom: var(--space-4);
            font-size: 1.1rem;
        }

        .threat-recommendations ul {
            list-style: none;
        }

        .threat-recommendations li {
            padding: var(--space-2) 0;
            display: flex;
            align-items: flex-start;
            gap: var(--space-2);
        }

        .threat-recommendations li:before {
            content: "â€¢";
            color: var(--primary);
            font-weight: bold;
        }

        .analysis-meta {
            padding: var(--space-4) var(--space-6);
            background: rgba(255, 255, 255, 0.03);
            text-align: center;
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: var(--space-4);
            border-radius: var(--radius-lg);
            color: white;
            z-index: 1000;
            max-width: 400px;
            box-shadow: var(--shadow-lg);
            animation: slideIn 0.3s ease-out;
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--error);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @media (max-width: 768px) {
            .input-container {
                flex-direction: column;
            }
            
            .ai-tools-status {
                flex-direction: column;
                align-items: center;
            }
            
            .threat-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .threat-details {
                grid-template-columns: 1fr;
            }
            
            .scan-results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="main.html" class="logo">
                <div class="logo-icon" aria-hidden="true">
                    <i class="fas fa-brain"></i>
                </div>
                <span>Cortex-Intell</span>
            </a>
            <div class="nav-actions">
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle light/dark mode">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <main id="main-content">
        <div class="container">
            <div class="analyzer-container">
                <div class="analyzer-content">
                    <div class="input-group">
                        <div class="input-header">
                            <h1>ðŸ¤– AI Website Security Scanner</h1>
                            <p>Real-time analysis using multiple AI security engines</p>
                        </div>
                        
                        <!-- AI Tools Status -->
                        <div class="ai-tools-status">
                            <div class="tool-status active">
                                <i class="fas fa-check-circle"></i>
                                <span>VirusTotal AI (Ready)</span>
                            </div>
                            <div class="tool-status active">
                                <i class="fas fa-check-circle"></i>
                                <span>Google Safe Browsing (Active)</span>
                            </div>
                            <div class="tool-status active">
                                <i class="fas fa-check-circle"></i>
                                <span>URLScan.io (Active)</span>
                            </div>
                        </div>

                        <div class="input-container">
                            <div class="input-with-icon">
                                <i class="fas fa-link" aria-hidden="true"></i>
                                <input type="url" id="websiteInput" placeholder="https://example.com" aria-label="Website URL to analyze">
                            </div>
                            <button class="btn btn-primary btn-large" id="scanWebsiteBtn" aria-label="Scan website for threats">
                                <i class="fas fa-robot" aria-hidden="true"></i>
                                AI Scan Website
                            </button>
                        </div>

                        <!-- API Keys Section -->
                        <div class="api-keys-section">
                            <details open>
                                <summary>ðŸ”‘ AI API Keys Configuration (All APIs Ready!)</summary>
                                <div class="api-keys-grid">
                                    <div class="api-key-input">
                                        <label>VirusTotal API Key:</label>
                                        <input type="password" id="virustotalApiKey" 
                                               value="e012fd82754c2452c2d251c90f779a3a5122f35ddaf20a90a16816943aa35a5f"
                                               placeholder="VirusTotal API Key">
                                        <small class="api-key-status">âœ… Using demo key (limited scans)</small>
                                    </div>
                                    <div class="api-key-input">
                                        <label>Google Safe Browsing API Key:</label>
                                        <input type="password" id="googleApiKey" 
                                               value="AIzaSyChwvpkmX1KTzJIkq4eMhrqExCesDV2rDI"
                                               placeholder="Google Safe Browsing API Key">
                                        <small class="api-key-status">âœ… Active â€¢ 10,000 free requests/day</small>
                                    </div>
                                    <div class="api-key-input">
                                        <label>URLScan.io API Key:</label>
                                        <input type="password" id="urlscanApiKey" 
                                               value="19a8e2c-23f1-7214-b111-97fb2d3d6452"
                                               placeholder="URLScan.io API Key">
                                        <small class="api-key-status">âœ… Active â€¢ 50 free scans/day</small>
                                    </div>
                                </div>
                                <div class="api-keys-status">
                                    <div class="status-badge success">
                                        <i class="fas fa-check-circle"></i>
                                        <span>All AI APIs Configured & Ready</span>
                                    </div>
                                </div>
                            </details>
                        </div>

                        <div class="sample-suggestions">
                            <span>Test AI Scanner:</span>
                            <button class="sample-btn" data-url="https://google.com">google.com</button>
                            <button class="sample-btn" data-url="https://github.com">github.com</button>
                            <button class="sample-btn" data-url="http://malware-test.com">malware-test.com</button>
                        </div>
                    </div>

                    <div class="results-area" id="resultsArea">
                        <div class="results-placeholder">
                            <div class="placeholder-icon">
                                <i class="fas fa-robot" aria-hidden="true"></i>
                            </div>
                            <h3>Ready for AI Analysis</h3>
                            <p>Enter a website URL for real AI-powered security scanning</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        class AIWebsiteScanner {
            constructor() {
                this.apis = {
                    virustotal: {
                        key: 'e012fd82754c2452c2d251c90f779a3a5122f35ddaf20a90a16816943aa35a5f',
                        baseURL: 'https://www.virustotal.com/api/v3'
                    },
                    google: {
                        key: 'AIzaSyChwvpkmX1KTzJIkq4eMhrqExCesDV2rDI',
                        baseURL: 'https://safebrowsing.googleapis.com/v4'
                    },
                    urlscan: {
                        key: '19a8e2c-23f1-7214-b111-97fb2d3d6452',
                        baseURL: 'https://urlscan.io/api/v1'
                    }
                };
            }

            async scanWebsite(url) {
                try {
                    this.updateAPIKeys();
                    
                    const results = {
                        url: url,
                        timestamp: new Date().toISOString(),
                        scans: {},
                        overallScore: 100,
                        status: 'clean',
                        threats: []
                    };

                    // Run multiple AI scans in parallel
                    const scanPromises = [];

                    // VirusTotal Scan
                    if (this.apis.virustotal.key) {
                        scanPromises.push(this.scanWithVirusTotal(url).then(result => {
                            results.scans.virustotal = result;
                            this.updateOverallScore(results, result);
                        }));
                    }

                    // Google Safe Browsing Scan
                    if (this.apis.google.key) {
                        scanPromises.push(this.scanWithGoogleSafeBrowsing(url).then(result => {
                            results.scans.google = result;
                            this.updateOverallScore(results, result);
                        }));
                    }

                    // URLScan.io Scan
                    if (this.apis.urlscan.key) {
                        scanPromises.push(this.scanWithURLScan(url).then(result => {
                            results.scans.urlscan = result;
                            this.updateOverallScore(results, result);
                        }));
                    }

                    // Basic domain analysis
                    scanPromises.push(this.basicDomainAnalysis(url).then(result => {
                        results.scans.domain = result;
                        this.updateOverallScore(results, result);
                    }));

                    await Promise.allSettled(scanPromises);

                    // Determine final status
                    results.status = this.determineFinalStatus(results);
                    
                    return results;

                } catch (error) {
                    throw new Error(`AI Website Scan failed: ${error.message}`);
                }
            }

            updateAPIKeys() {
                const vtKey = document.getElementById('virustotalApiKey')?.value;
                const googleKey = document.getElementById('googleApiKey')?.value;
                const urlscanKey = document.getElementById('urlscanApiKey')?.value;

                if (vtKey) this.apis.virustotal.key = vtKey;
                if (googleKey) this.apis.google.key = googleKey;
                if (urlscanKey) this.apis.urlscan.key = urlscanKey;
            }

            async scanWithVirusTotal(url) {
                try {
                    // Submit URL for scanning
                    const submitResponse = await fetch(`${this.apis.virustotal.baseURL}/urls`, {
                        method: 'POST',
                        headers: {
                            'x-apikey': this.apis.virustotal.key,
                            'Content-Type': 'application/x-www-form-urlencoded'
                        },
                        body: `url=${encodeURIComponent(url)}`
                    });

                    if (!submitResponse.ok) throw new Error('VirusTotal submission failed');

                    const submitData = await submitResponse.json();
                    const analysisId = submitData.data.id;

                    // Wait for analysis
                    await new Promise(resolve => setTimeout(resolve, 3000));

                    // Get results
                    const analysisResponse = await fetch(`${this.apis.virustotal.baseURL}/analyses/${analysisId}`, {
                        headers: {
                            'x-apikey': this.apis.virustotal.key
                        }
                    });

                    if (!analysisResponse.ok) throw new Error('VirusTotal analysis failed');

                    const analysisData = await analysisResponse.json();
                    const stats = analysisData.data.attributes.stats;

                    return {
                        engine: 'VirusTotal',
                        malicious: stats.malicious || 0,
                        suspicious: stats.suspicious || 0,
                        undetected: stats.undetected || 0,
                        harmless: stats.harmless || 0,
                        totalEngines: Object.keys(analysisData.data.attributes.results || {}).length,
                        status: stats.malicious > 0 ? 'malicious' : stats.suspicious > 0 ? 'suspicious' : 'clean',
                        results: analysisData.data.attributes.results || {}
                    };

                } catch (error) {
                    console.error('VirusTotal scan error:', error);
                    return { engine: 'VirusTotal', error: error.message, status: 'error' };
                }
            }

            async scanWithGoogleSafeBrowsing(url) {
                const apiKey = this.apis.google.key;
                
                if (!apiKey) {
                    return { 
                        engine: 'Google Safe Browsing', 
                        error: 'API key required',
                        status: 'disabled'
                    };
                }

                // Validate key format
                if (!apiKey.startsWith('AIza')) {
                    return {
                        engine: 'Google Safe Browsing',
                        error: 'Invalid API key format',
                        status: 'error'
                    };
                }

                try {
                    const response = await fetch(`${this.apis.google.baseURL}/threatMatches:find?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            client: {
                                clientId: "cortex-intell-scanner",
                                clientVersion: "1.0.0"
                            },
                            threatInfo: {
                                threatTypes: ["MALWARE", "SOCIAL_ENGINEERING", "UNWANTED_SOFTWARE", "POTENTIALLY_HARMFUL_APPLICATION"],
                                platformTypes: ["ANY_PLATFORM"],
                                threatEntryTypes: ["URL"],
                                threatEntries: [{ url: url }]
                            }
                        })
                    });

                    const data = await response.json();

                    if (!response.ok) {
                        if (response.status === 400) {
                            throw new Error('Invalid request - Check URL format');
                        } else if (response.status === 403) {
                            throw new Error('API not enabled or billing required');
                        } else if (response.status === 429) {
                            throw new Error('Rate limit exceeded - Try again later');
                        } else {
                            throw new Error(`API error: ${response.status}`);
                        }
                    }

                    return {
                        engine: 'Google Safe Browsing',
                        threats: data.matches || [],
                        status: data.matches && data.matches.length > 0 ? 'malicious' : 'clean',
                        threatCount: data.matches ? data.matches.length : 0,
                        threatTypes: data.matches ? data.matches.map(m => m.threatType) : [],
                        confidence: 'high'
                    };

                } catch (error) {
                    console.error('Google Safe Browsing error:', error);
                    return { engine: 'Google Safe Browsing', error: error.message, status: 'error' };
                }
            }

            async scanWithURLScan(url) {
                const apiKey = this.apis.urlscan.key;
                
                if (!apiKey) {
                    return { 
                        engine: 'URLScan.io', 
                        error: 'API key required',
                        status: 'disabled'
                    };
                }

                try {
                    // Submit URL for scanning
                    const submitResponse = await fetch(`${this.apis.urlscan.baseURL}/scan/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'API-Key': apiKey
                        },
                        body: JSON.stringify({
                            url: url,
                            visibility: 'public',
                            tags: ['security-scan', 'cortex-intell']
                        })
                    });

                    if (submitResponse.status === 401) {
                        throw new Error('Invalid URLScan.io API key');
                    }
                    
                    if (!submitResponse.ok) {
                        const errorText = await submitResponse.text();
                        throw new Error(`URLScan submission failed: ${submitResponse.status}`);
                    }

                    const submitData = await submitResponse.json();
                    
                    // Wait for results with progress updates
                    let attempts = 0;
                    const maxAttempts = 8;
                    
                    while (attempts < maxAttempts) {
                        await new Promise(resolve => setTimeout(resolve, 2000));
                        attempts++;
                        
                        // Get results
                        const resultResponse = await fetch(`${this.apis.urlscan.baseURL}/result/${submitData.uuid}/`);
                        
                        if (resultResponse.status === 404) {
                            continue;
                        }
                        
                        if (!resultResponse.ok) {
                            throw new Error(`Failed to fetch results: ${resultResponse.status}`);
                        }
                        
                        const resultData = await resultResponse.json();
                        
                        if (resultData.task?.status === 'complete') {
                            return {
                                engine: 'URLScan.io',
                                verdicts: resultData.verdicts || {},
                                status: resultData.verdicts?.overall?.malicious ? 'malicious' : 
                                       resultData.verdicts?.overall?.score < 0 ? 'suspicious' : 'clean',
                                score: resultData.verdicts?.overall?.score || 0,
                                pageData: {
                                    country: resultData.page?.country,
                                    ip: resultData.page?.ip,
                                    server: resultData.page?.server
                                },
                                screenshot: resultData.task?.screenshotURL,
                                reportURL: resultData.task?.reportURL,
                                scanID: submitData.uuid
                            };
                        }
                    }
                    
                    throw new Error('URLScan.io analysis timeout');

                } catch (error) {
                    console.error('URLScan.io error:', error);
                    return { engine: 'URLScan.io', error: error.message, status: 'error' };
                }
            }

            async basicDomainAnalysis(url) {
                try {
                    const domain = new URL(url).hostname;
                    
                    // Check for suspicious patterns
                    const suspiciousPatterns = this.checkSuspiciousPatterns(domain);
                    const reputationScore = this.calculateDomainReputation(domain);

                    return {
                        engine: 'Domain Analysis',
                        domain: domain,
                        reputationScore: reputationScore,
                        suspiciousPatterns: suspiciousPatterns,
                        status: suspiciousPatterns.length > 0 || reputationScore < 50 ? 'suspicious' : 'clean'
                    };

                } catch (error) {
                    return { engine: 'Domain Analysis', error: error.message, status: 'error' };
                }
            }

            checkSuspiciousPatterns(domain) {
                const patterns = [];
                const suspiciousKeywords = ['free', 'crack', 'keygen', 'serial', 'torrent', 'download', 'nulled'];
                
                suspiciousKeywords.forEach(keyword => {
                    if (domain.includes(keyword)) {
                        patterns.push(`Contains suspicious keyword: "${keyword}"`);
                    }
                });

                // Check for IP address instead of domain
                if (/^(\d+\.){3}\d+$/.test(domain.replace(/^www\./, ''))) {
                    patterns.push('Uses IP address instead of domain name');
                }

                // Check for excessive hyphens
                if ((domain.match(/-/g) || []).length > 2) {
                    patterns.push('Excessive hyphens in domain name');
                }

                return patterns;
            }

            calculateDomainReputation(domain) {
                // Simple reputation scoring
                let score = 70;

                // TLD reputation
                const goodTlds = ['.com', '.org', '.net', '.edu', '.gov'];
                const badTlds = ['.tk', '.ml', '.ga', '.cf', '.xyz'];
                
                if (badTlds.some(tld => domain.endsWith(tld))) score -= 20;
                if (goodTlds.some(tld => domain.endsWith(tld))) score += 5;

                // Domain length heuristic
                if (domain.length < 10) score += 10;
                if (domain.length > 20) score -= 5;

                return Math.max(10, Math.min(100, score));
            }

            updateOverallScore(results, scanResult) {
                if (scanResult.status === 'malicious') {
                    results.overallScore -= 30;
                    results.threats.push(`${scanResult.engine}: Malicious content detected`);
                } else if (scanResult.status === 'suspicious') {
                    results.overallScore -= 15;
                    results.threats.push(`${scanResult.engine}: Suspicious activity`);
                } else if (scanResult.status === 'error') {
                    results.overallScore -= 5;
                }

                results.overallScore = Math.max(0, Math.min(100, results.overallScore));
            }

            determineFinalStatus(results) {
                if (results.overallScore >= 80) return 'clean';
                if (results.overallScore >= 60) return 'suspicious';
                return 'malicious';
            }
        }

        // Main scan functionality
        document.getElementById('scanWebsiteBtn').addEventListener('click', async function() {
            const url = document.getElementById('websiteInput').value;
            const resultsArea = document.getElementById('resultsArea');
            const btn = this;
            
            if (!url) {
                showError('Please enter a website URL to analyze.');
                return;
            }

            // Validate URL format
            try {
                new URL(url);
            } catch {
                showError('Please enter a valid URL (e.g., https://example.com)');
                return;
            }

            // Show loading
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> AI Analyzing...';
            
            resultsArea.innerHTML = `
                <div class="loading-state">
                    <div class="loading-spinner">
                        <i class="fas fa-robot fa-spin"></i>
                    </div>
                    <h3>ðŸ¤– AI Website Analysis in Progress</h3>
                    <p>Scanning with 3 AI security engines in parallel...</p>
                    <div class="loading-steps">
                        <div class="loading-step active">
                            <i class="fas fa-shield-alt"></i>
                            <span>VirusTotal (70+ engines) - Scanning</span>
                        </div>
                        <div class="loading-step active">
                            <i class="fab fa-google"></i>
                            <span>Google Safe Browsing - Active</span>
                        </div>
                        <div class="loading-step active">
                            <i class="fas fa-search"></i>
                            <span>URLScan.io - Deep Analysis</span>
                        </div>
                    </div>
                    <div class="scan-progress">
                        <div class="progress-text">Initializing all AI engines...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 33%"></div>
                        </div>
                    </div>
                </div>
            `;

            try {
                const scanner = new AIWebsiteScanner();
                const results = await scanner.scanWebsite(url);
                
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-robot"></i> AI Scan Website';
                
                displayAIWebsiteResults(results);
                
            } catch (error) {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-robot"></i> AI Scan Website';
                
                showError(`AI Scan Failed: ${error.message}`);
            }
        });

        function displayAIWebsiteResults(results) {
            const resultsArea = document.getElementById('resultsArea');
            const statusClass = results.status === 'clean' ? 'clean' : 
                              results.status === 'suspicious' ? 'suspicious' : 'malicious';
            
            const statusIcon = results.status === 'clean' ? 'âœ…' :
                             results.status === 'suspicious' ? 'âš ï¸' : 'ðŸš«';

            const statusText = results.status === 'clean' ? 'SAFE WEBSITE' :
                              results.status === 'suspicious' ? 'SUSPICIOUS WEBSITE' : 'MALICIOUS WEBSITE';

            // Count active scans
            const activeScans = Object.values(results.scans).filter(scan => !scan.error).length;
            
            let scanResultsHTML = '';

            // Display results from each AI engine with enhanced info
            Object.values(results.scans).forEach(scan => {
                if (scan.error) return;

                const cardClass = scan.status === 'clean' ? 'safe' : 
                                 scan.status === 'suspicious' ? 'warning' : 'danger';

                let scanDetails = '';
                
                if (scan.engine === 'VirusTotal') {
                    scanDetails = `
                        <div class="scan-stats">
                            <small>ðŸ›¡ï¸ Engines: ${scan.totalEngines || 'N/A'}</small>
                            <small>ðŸš« Malicious: ${scan.malicious || 0}</small>
                            <small>âš ï¸ Suspicious: ${scan.suspicious || 0}</small>
                        </div>
                    `;
                } else if (scan.engine === 'Google Safe Browsing') {
                    scanDetails = `
                        <div class="scan-stats">
                            <small>ðŸ” Threats: ${scan.threatCount || 0}</small>
                            <small>ðŸ“Š Confidence: High</small>
                        </div>
                    `;
                } else if (scan.engine === 'URLScan.io') {
                    scanDetails = `
                        <div class="scan-stats">
                            <small>ðŸŒ Country: ${scan.pageData?.country || 'Unknown'}</small>
                            <small>ðŸ“ˆ Score: ${scan.score || 'N/A'}</small>
                            ${scan.reportURL ? `<small><a href="${scan.reportURL}" target="_blank" style="color: var(--primary);">View Full Report</a></small>` : ''}
                        </div>
                    `;
                } else if (scan.engine === 'Domain Analysis') {
                    scanDetails = `
                        <div class="scan-stats">
                            <small>â­ Reputation: ${scan.reputationScore || 0}/100</small>
                            <small>ðŸ” Patterns: ${scan.suspiciousPatterns?.length || 0}</small>
                        </div>
                    `;
                }

                scanResultsHTML += `
                    <div class="scan-result-card ${cardClass}">
                        <h4>${scan.engine}</h4>
                        <div class="scan-status ${scan.status}">${scan.status.toUpperCase()}</div>
                        ${scanDetails}
                    </div>
                `;
            });

            resultsArea.innerHTML = `
                <div class="threat-result ${statusClass}">
                    <div class="threat-header">
                        <h3 class="threat-title">ðŸ¤– AI Website Security Report</h3>
                        <div class="threat-confidence confidence-${results.status === 'clean' ? 'high' : results.status === 'suspicious' ? 'medium' : 'low'}">
                            ${statusIcon} ${statusText}
                        </div>
                    </div>
                    
                    <div class="threat-details">
                        <div class="detail-item">
                            <h4>AI Security Score</h4>
                            <p>${results.overallScore}/100</p>
                        </div>
                        <div class="detail-item">
                            <h4>Website URL</h4>
                            <p style="word-break: break-all;">${results.url}</p>
                        </div>
                        <div class="detail-item">
                            <h4>Scan Engines</h4>
                            <p>${activeScans}/4 AI engines active</p>
                        </div>
                        <div class="detail-item">
                            <h4>Analysis Time</h4>
                            <p>${new Date(results.timestamp).toLocaleTimeString()}</p>
                        </div>
                    </div>

                    <div class="scan-results-section">
                        <h4>ðŸ” AI Engine Results</h4>
                        <div class="scan-results-grid">
                            ${scanResultsHTML || '<p>No scan results available</p>'}
                        </div>
                    </div>

                    ${results.threats.length > 0 ? `
                        <div class="threat-recommendations">
                            <h4>ðŸš¨ Detected Threats</h4>
                            <ul>
                                ${results.threats.map(threat => `<li>${threat}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}

                    <div class="threat-recommendations">
                        <h4>AI Security Recommendations</h4>
                        <ul>
                            ${results.status === 'clean' ? `
                                <li>âœ… Website appears safe across all AI engines</li>
                                <li>âœ… No malicious content detected by Google Safe Browsing</li>
                                <li>âœ… URLScan.io deep analysis shows clean results</li>
                                <li>âœ… VirusTotal multi-engine scan confirms safety</li>
                            ` : results.status === 'suspicious' ? `
                                <li>âš ï¸ Exercise caution with this website</li>
                                <li>ðŸ” Suspicious patterns detected by AI engines</li>
                                <li>ðŸ›¡ï¸ Avoid entering sensitive information</li>
                                <li>ðŸ“Š Multiple security vendors flagged concerns</li>
                            ` : `
                                <li>ðŸš« MALICIOUS WEBSITE DETECTED</li>
                                <li>ðŸ›‘ DO NOT VISIT OR DOWNLOAD FROM THIS SITE</li>
                                <li>ðŸ”’ Multiple AI engines confirm security threats</li>
                                <li>ðŸ“ž Consider reporting to cybersecurity authorities</li>
                            `}
                        </ul>
                    </div>

                    <div class="analysis-meta">
                        <small>AI Analysis powered by VirusTotal, Google Safe Browsing, URLScan.io â€¢ ${new Date(results.timestamp).toLocaleString()}</small>
                    </div>
                </div>
            `;
        }

        function showError(message) {
            const resultsArea = document.getElementById('resultsArea');
            resultsArea.innerHTML = `
                <div class="threat-result malicious">
                    <div class="threat-header">
                        <h3 class="threat-title">AI Scan Error</h3>
                        <div class="threat-confidence confidence-low">âŒ ERROR</div>
                    </div>
                    <p>${message}</p>
                </div>
            `;
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-${type === 'success' ? 'check' : 'exclamation'}-circle"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Sample buttons
        document.querySelectorAll('.sample-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.getElementById('websiteInput').value = this.dataset.url;
            });
        });

        // Theme toggle
        document.getElementById('themeToggle').addEventListener('click', function() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            const icon = document.querySelector('.theme-toggle i');
            if (icon) {
                icon.className = newTheme === 'light' ? 'fas fa-sun' : 'fas fa-moon';
            }
        });

        // Test all AI engines on load
        async function testAllAIEngines() {
            console.log('ðŸ§ª Testing All AI Security Engines...');
            
            const testUrl = 'https://google.com';
            const scanner = new AIWebsiteScanner();
            
            try {
                // Test Google Safe Browsing
                console.log('1. Testing Google Safe Browsing...');
                const googleResult = await scanner.scanWithGoogleSafeBrowsing(testUrl);
                console.log('Google Result:', googleResult);
                
                // Test URLScan.io
                console.log('2. Testing URLScan.io...');
                const urlscanResult = await scanner.scanWithURLScan(testUrl);
                console.log('URLScan Result:', urlscanResult);
                
                showNotification('ðŸŽ‰ All AI Engines Working! Google Safe Browsing + URLScan.io + VirusTotal', 'success');
                
            } catch (error) {
                console.error('AI Engine Test Failed:', error);
                showNotification('âš ï¸ Some AI engines failed: ' + error.message, 'error');
            }
        }

        // Load saved theme and test engines
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            const themeIcon = document.querySelector('.theme-toggle i');
            if (themeIcon) {
                themeIcon.className = savedTheme === 'light' ? 'fas fa-sun' : 'fas fa-moon';
            }
            
            // Test engines after a short delay
            setTimeout(testAllAIEngines, 1000);
        });
    </script>
</body>
</html>